createOrReplace
	table 'Time Intelligence'
		
		calculationGroup
			calculationItem Metric = SELECTEDMEASURE()
				formatStringDefinition = "#,##0"
			calculationItem YTD = CALCULATE(SELECTEDMEASURE(), DATESYTD(dimFechas[Fecha]))
				formatStringDefinition = "#,##0"
			calculationItem MTD = CALCULATE(SELECTEDMEASURE(), DATESMTD(dimFechas[Fecha]))
				formatStringDefinition = "#,##0"
			calculationItem QTD = CALCULATE(SELECTEDMEASURE(), DATESQTD(dimFechas[Fecha]))
				formatStringDefinition = "#,##0"
			calculationItem Current_Year = CALCULATE(SELECTEDMEASURE(), YEAR(dimFechas[Fecha]) = YEAR(TODAY()))
				formatStringDefinition = "#,##0"
			calculationItem Previous_Year = CALCULATE(SELECTEDMEASURE(), YEAR(dimFechas[Fecha]) = YEAR(TODAY()) - 1)
				formatStringDefinition = "#,##0"
			calculationItem Current_Quarter = CALCULATE(SELECTEDMEASURE(), QUARTER(dimFechas[Fecha]) = QUARTER(TODAY()) && YEAR(dimFechas[Fecha]) = YEAR(TODAY()))
				formatStringDefinition = "#,##0"
			calculationItem Previous_Quarter = CALCULATE(SELECTEDMEASURE(), QUARTER(dimFechas[Fecha]) = QUARTER(TODAY()) - 1 && YEAR(dimFechas[Fecha]) = YEAR(TODAY()))
				formatStringDefinition = "#,##0"
			calculationItem Current_Month = CALCULATE(SELECTEDMEASURE(), MONTH(dimFechas[Fecha]) = MONTH(TODAY()) && YEAR(dimFechas[Fecha]) = YEAR(TODAY()))
				formatStringDefinition = "#,##0"
			calculationItem Previous_Month = CALCULATE(SELECTEDMEASURE(), MONTH(dimFechas[Fecha]) = MONTH(TODAY()) - 1 && YEAR(dimFechas[Fecha]) = YEAR(TODAY()))
				formatStringDefinition = "#,##0"
			calculationItem YoY_Growth = SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), SAMEPERIODLASTYEAR(dimFechas[Fecha]))
				formatStringDefinition = "#,##0"
			calculationItem YoY_Percentage_Change = DIVIDE(SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), SAMEPERIODLASTYEAR(dimFechas[Fecha])), CALCULATE(SELECTEDMEASURE(), SAMEPERIODLASTYEAR(dimFechas[Fecha])))
				formatStringDefinition = "0.00%"
			calculationItem QoQ_Growth = SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, QUARTER))
				formatStringDefinition = "#,##0"
			calculationItem QoQ_Percentage_Change = DIVIDE(SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, QUARTER)), CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, QUARTER)))
				formatStringDefinition = "0.00%"
			calculationItem MoM_Growth = SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, MONTH))
				formatStringDefinition = "#,##0"
			calculationItem MoM_Change = DIVIDE(SELECTEDMEASURE() - CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, MONTH)), CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, MONTH)))
				formatStringDefinition = "0.00%"
			calculationItem Same_Period_Last_Year = CALCULATE(SELECTEDMEASURE(), SAMEPERIODLASTYEAR(dimFechas[Fecha]))
				formatStringDefinition = "#,##0"
			calculationItem Same_Period_Last_Month = CALCULATE(SELECTEDMEASURE(), DATEADD(dimFechas[Fecha], -1, MONTH))
				formatStringDefinition = "#,##0"
			calculationItem Moving_Avg_1M = CALCULATE(AVERAGEX(VALUES(dimFechas[MesCorto]), SELECTEDMEASURE()), DATESINPERIOD(dimFechas[Fecha], MAX(dimFechas[Fecha]), -1, MONTH))
				formatStringDefinition = "#,##0.00"
			calculationItem Moving_Avg_3M = CALCULATE(AVERAGEX(VALUES(dimFechas[MesCorto]), SELECTEDMEASURE()), DATESINPERIOD(dimFechas[Fecha], MAX(dimFechas[Fecha]), -3, MONTH))
				formatStringDefinition = "#,##0.00"
			calculationItem Moving_Avg_6M = CALCULATE(AVERAGEX(VALUES(dimFechas[MesCorto]), SELECTEDMEASURE()), DATESINPERIOD(dimFechas[Fecha], MAX(dimFechas[Fecha]), -6, MONTH))
				formatStringDefinition = "#,##0.00"
			calculationItem Moving_Avg_9M = CALCULATE(AVERAGEX(VALUES(dimFechas[MesCorto]), SELECTEDMEASURE()), DATESINPERIOD(dimFechas[Fecha], MAX(dimFechas[Fecha]), -9, MONTH))
				formatStringDefinition = "#,##0.00"
			calculationItem Moving_Avg_12M = CALCULATE(AVERAGEX(VALUES(dimFechas[MesCorto]), SELECTEDMEASURE()), DATESINPERIOD(dimFechas[Fecha], MAX(dimFechas[Fecha]), -12, MONTH))
				formatStringDefinition = "#,##0.00"
		column 'Calculation group column'
			dataType: string
			summarizeBy: none
			sourceColumn: Name
			sortByColumn: Ordinal
			annotation SummarizationSetBy = Automatic
		column Ordinal
			dataType: int64
			formatString: 0
			summarizeBy: none
			sourceColumn: Ordinal
			annotation SummarizationSetBy = Automatic
